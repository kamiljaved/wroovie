{% extends "common/base.html" %}
{% load static %}
{% load humanize %}
{% load mptt_tags %}
{% load extra_tags %}


{% block title %}
    {{ post.title | truncatechars:35 }} | {{ post.community.name | truncatechars:25 }} - wroovie
{% endblock %}

{% block browse_current_page_name %}
    c/{{ post.community.name | truncatechars:15 }}
{% endblock %}

{% block browse_current_page_icon %}
    <img class="" src="{{ post.community.icon.url }}" alt="Community Image">
{% endblock %}

{% block stylesheets %}
    <link rel="stylesheet" type="text/css" href="{% static 'common/css/style.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'common/css/style-scale.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'posts/css/base.css' %}">

    {% if user.is_authenticated %}
        <link rel="stylesheet" type="text/css" href="{% static 'common/css/trix.css' %}">
    {% endif %}
{% endblock %}


{% block fonts %}
    <link href="https://fonts.googleapis.com/css2?family=Nixie+One&display=swap" rel="stylesheet">
{% endblock %}

{% block main %}

    <div class="wrapper">
        {% block banner %}
        {% endblock %}

        <div class="comm-1">
            <!-- TODO: Need styling and option to choose number of days, and method of sort -->
            <!-- <div class="display-timeframe">
                 days search data
            </div> -->
            <div class="comm-1-1 wrap-main-content">
                <div class="comm-content-box pdetail">
    
                    <div class="comm-content-box-1">
                        
                        {% if user.is_authenticated %}
                        <div class="post-vote-button upvote-button {% if user in post.upvotes.all %} sel {% endif %}" id="pst-upvt-btn-{{ post.id }}" onclick="event.stopPropagation(); postUpvote(event, {{post.id}});">
                        {% else %}    
                        <div class="post-vote-button upvote-button" onclick="event.stopPropagation(); window.location.href='{% url 'login' %}?next={{request.path}}'">
                        {% endif %}
                            <svg aria-hidden="true" focusable="false" data-prefix="fad" data-icon="arrow-alt-square-up" role="img"
                                xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"
                                class="svg-inline--fa fa-arrow-alt-square-up fa-w-14 fa-9x">
                                <g class="fa-group">
                                    <path fill="currentColor"
                                        d="M400 32H48A48 48 0 0 0 0 80v352a48 48 0 0 0 48 48h352a48 48 0 0 0 48-48V80a48 48 0 0 0-48-48zm-60.15 224h-71.49v116a12.07 12.07 0 0 1-12.1 12h-64.52a12.07 12.07 0 0 1-12.1-12V256h-71.49c-10.78 0-16.23-12.83-8.57-20.32l116-115.16a12.08 12.08 0 0 1 17 0l115.84 115.16c7.66 7.49 2.21 20.32-8.57 20.32z"
                                        class="fa-secondary"></path>
                                    <path fill="currentColor"
                                        d="M256.26 384h-64.52a12.07 12.07 0 0 1-12.1-12V256h-71.49c-10.78 0-16.23-12.83-8.57-20.32l116-115.16a12.08 12.08 0 0 1 17 0l115.84 115.16c7.66 7.49 2.21 20.32-8.57 20.32h-71.49v116a12.07 12.07 0 0 1-12.1 12z"
                                        class="fa-primary"></path>
                                </g>
                            </svg>
                        </div>
                
                        <div class="post-score" id="pst-score-div-{{ post.id }}">
                            {% subtract_and_cool_number post.upvotes.count post.downvotes.count %}
                        </div>
                        
                        {% if user.is_authenticated %}
                        <div class="post-vote-button downvote-button {% if user in post.downvotes.all %} sel {% endif %}" id="pst-dnvt-btn-{{ post.id }}" onclick="event.stopPropagation(); postDownvote(event, {{post.id}});">
                        {% else %}    
                        <div class="post-vote-button downvote-button" onclick="event.stopPropagation();  window.location.href='{% url 'login' %}?next={{request.path}}'">
                        {% endif %}

                            <svg aria-hidden="true" focusable="false" data-prefix="fad" data-icon="arrow-alt-square-down" role="img"
                                xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"
                                class="svg-inline--fa fa-arrow-alt-square-down fa-w-14 fa-9x">
                                <g class="fa-group">
                                    <path fill="currentColor"
                                        d="M400 32H48A48 48 0 0 0 0 80v352a48 48 0 0 0 48 48h352a48 48 0 0 0 48-48V80a48 48 0 0 0-48-48zm-51.58 244.32l-116 115.16a12.08 12.08 0 0 1-17 0L99.58 276.32c-7.66-7.49-2.21-20.32 8.57-20.32h71.49V140a12.07 12.07 0 0 1 12.1-12h64.52a12.07 12.07 0 0 1 12.1 12v116h71.49c10.78 0 16.23 12.83 8.57 20.32z"
                                        class="fa-secondary"></path>
                                    <path fill="currentColor"
                                        d="M191.74 128h64.52a12.07 12.07 0 0 1 12.1 12v116h71.49c10.78 0 16.23 12.83 8.57 20.32l-116 115.16a12.08 12.08 0 0 1-17 0L99.58 276.32c-7.66-7.49-2.21-20.32 8.57-20.32h71.49V140a12.07 12.07 0 0 1 12.1-12z"
                                        class="fa-primary"></path>
                                </g>
                            </svg>
                        </div>
                
                    </div>
                
                    <div class="comm-content-box-2">
                        
                        <div class="post-info">
                            {% if show_comm_info %} 
                                <div class="post-community-image-wrapper">
                                    <img class="post-community-image" src="{{ post.community.icon.url }}" alt="Community Icon">
                                </div>
                                <strong class="post-community-name">    
                                    <a href="{% url 'community-home' post.community.name %}" onclick="event.stopPropagation();">c/{{ post.community.name }}</a>
                                </strong>
                                &nbsp | 
                            {% endif %}
                            
                             
                            {{ post.get_type }} | Posted by
                            <div class="post-author-image-wrapper">
                                <img class="post-author-image" src="{{ post.author.profile.image.url }}" alt="Author Image">
                            </div>
                            <a href = "{% url 'profile' post.author %}" onclick="event.stopPropagation();">u/{{ post.author }}</a>
                            <div class="post-time">
                                | {{ post.dt_creation | naturaltime }}
                            </div>
                        </div>
                        
                        {% if post.is_thread %}
                        {% include "posts/thread.html" %}
                        {% else %}
                        {% include "posts/article.html" %}
                        {% endif %}
                
                        <div class="post-options">
                            <div class="post-options-button" onclick="event.stopPropagation();">
                                <svg aria-hidden="true" focusable="false" data-prefix="fad" data-icon="comments-alt" role="img"
                                    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"
                                    class="svg-inline--fa fa-comments-alt fa-w-18 fa-9x">
                                    <g class="fa-group">
                                        <path fill="currentColor"
                                            d="M352 287.9H162.3L79.5 350a9.7 9.7 0 0 1-15.5-7.8V288a64.06 64.06 0 0 1-64-64V64A64.06 64.06 0 0 1 64 0h288a64.06 64.06 0 0 1 64 64v160a63.91 63.91 0 0 1-64 63.9z"
                                            class="fa-secondary"></path>
                                        <path fill="currentColor"
                                            d="M576 224v160a64.06 64.06 0 0 1-64 64h-32v54.3a9.7 9.7 0 0 1-15.5 7.8L381.7 448H256a64.06 64.06 0 0 1-64-64v-64h160a96.15 96.15 0 0 0 96-96v-64h64a64.06 64.06 0 0 1 64 64z"
                                            class="fa-primary"></path>
                                    </g>
                                </svg>
                                <div class="post-options-button-text" onclick="document.getElementById('navpoint-comments').scrollIntoView()">
                                    {% if reply_count == 1 %}
                                        1 Comment
                                    {% else %}
                                        {{ reply_count }} Comments
                                    {% endif %}
                                </div>
                            </div>
                            <div class="post-options-button" onclick="event.stopPropagation();">
                                <svg aria-hidden="true" focusable="false" data-prefix="fad" data-icon="share-alt" role="img"
                                    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"
                                    class="svg-inline--fa fa-share-alt fa-w-14 fa-9x">
                                    <g class="fa-group">
                                        <path fill="currentColor"
                                            d="M155.79 180.9l102.49-64.06a95.93 95.93 0 0 0 33.93 54.26l-102.49 64.06a95.93 95.93 0 0 0-33.93-54.26zm136.42 160l-102.49-64.06a95.93 95.93 0 0 1-33.93 54.26l102.49 64.06a95.93 95.93 0 0 1 33.93-54.26z"
                                            class="fa-primary"></path>
                                        <path fill="currentColor"
                                            d="M96 160a96 96 0 1 0 96 96 96 96 0 0 0-96-96zm256 32a96 96 0 1 0-96-96 96 96 0 0 0 96 96zm0 128a96 96 0 1 0 96 96 96 96 0 0 0-96-96z"
                                            class="fa-secondary"></path>
                                    </g>
                                </svg>
                                <div class="post-options-button-text">Share</div>
                            </div>
                            {% if user.is_authenticated %}
                            <div class="post-options-button save-btn {% if post in user.profile.saved_posts.all %} sel {% endif %}" onclick="event.stopPropagation(); postSaveToggle(event, {{post.id}});">
                                <svg aria-hidden="true" focusable="false" data-prefix="fad" data-icon="bookmark" role="img"
                                    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"
                                    class="svg-inline--fa fa-bookmark fa-w-12 fa-9x">
                                    <g class="fa-group">
                                        <path fill="currentColor"
                                            d="M384 48v464L192 400 0 512V48A48 48 0 0 1 48 0h32v326.11a16 16 0 0 0 23.16 14.31L192 296l88.84 44.42A16 16 0 0 0 304 326.11V0h32a48 48 0 0 1 48 48z"
                                            class="fa-primary"></path>
                                        <path fill="currentColor"
                                            d="M304 0v326.11a16 16 0 0 1-23.16 14.31L192 296l-88.84 44.42A16 16 0 0 1 80 326.11V0z"
                                            class="fa-secondary"></path>
                                    </g>
                                </svg>
                                <div class="post-options-button-text">{% if post in user.profile.saved_posts.all %}Saved{% else %}Save{% endif %}</div>
                            </div>
                            {% endif %}
                            <div class="post-options-button" onclick="event.stopPropagation();">
                                <svg aria-hidden="true" focusable="false" data-prefix="fad" data-icon="ellipsis-h" role="img"
                                    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
                                    class="svg-inline--fa fa-ellipsis-h fa-w-16 fa-9x">
                                    <g class="fa-group">
                                        <path fill="currentColor" d="M256 184a72 72 0 1 0 72 72 72 72 0 0 0-72-72z" class="fa-primary">
                                        </path>
                                        <path fill="currentColor"
                                            d="M432 184a72 72 0 1 0 72 72 72 72 0 0 0-72-72zm-352 0a72 72 0 1 0 72 72 72 72 0 0 0-72-72z"
                                            class="fa-secondary"></path>
                                    </g>
                                </svg>
                            </div>
                        </div>
                        
                        {% if user.is_authenticated %}
                        <div class="post-options">
                            <form class="reply-editor main" parent="">
                                <span class="editor-block">
                                    <input id="x" type="hidden" name="content" value="">
                                    <trix-editor input="x"></trix-editor>
                                </span>
                                <div class="community-button p-comm-btn-submit reply-btn-submit disabled">
                                    <div class="community-button-text">SUBMIT REPLY</div>
                                </div>
                           </form>
                        </div>
                        {% else %}
                        <div class="post-options p-d-opt">
                            <div class="community-button p-log-in" onclick="window.location.href='{% url 'login'%}?next={{request.path}}'">
                                <div class="community-button-text">LOG IN</div>
                            </div>
                            <div class="info-text">or</div>
                            <div class="community-button p-log-in">
                                <div class="community-button-text" onclick="window.location.href='{% url 'register'%}'">SIGN UP</div>
                            </div>
                            <div class="info-text">to leave a reply</div>
                        </div>
                        {% endif %}
                    </div>
                
                </div>




                <!-- post replies -->
                <span id="navpoint-comments"></span>
                {{ replies.count | cool_number }} replies<br/>
                <span class="gap-sm"></span>

                <span id="new-main-replies"></span>

                {% recursetree replies %}
                <div class="comm-content-box pdetail {% if not node.level == 0 %} rsub {% endif %}" id='rply-container-{{node.id}}'>

                    <div class="comm-content-box-1">

                        {% if user.is_authenticated %}
                        <div class="post-vote-button upvote-button {% if user in node.upvotes.all %} sel {% endif %}" id="rply-upvt-btn-{{ node.id }}" onclick="event.stopPropagation(); replyUpvote(event, {{node.id}});">
                        {% else %}    
                        <div class="post-vote-button upvote-button" onclick="event.stopPropagation();">
                        {% endif %}
                            <svg aria-hidden="true" focusable="false" data-prefix="fad" data-icon="arrow-alt-square-up" role="img"
                                xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"
                                class="svg-inline--fa fa-arrow-alt-square-up fa-w-14 fa-9x">
                                <g class="fa-group">
                                    <path fill="currentColor"
                                        d="M400 32H48A48 48 0 0 0 0 80v352a48 48 0 0 0 48 48h352a48 48 0 0 0 48-48V80a48 48 0 0 0-48-48zm-60.15 224h-71.49v116a12.07 12.07 0 0 1-12.1 12h-64.52a12.07 12.07 0 0 1-12.1-12V256h-71.49c-10.78 0-16.23-12.83-8.57-20.32l116-115.16a12.08 12.08 0 0 1 17 0l115.84 115.16c7.66 7.49 2.21 20.32-8.57 20.32z"
                                        class="fa-secondary"></path>
                                    <path fill="currentColor"
                                        d="M256.26 384h-64.52a12.07 12.07 0 0 1-12.1-12V256h-71.49c-10.78 0-16.23-12.83-8.57-20.32l116-115.16a12.08 12.08 0 0 1 17 0l115.84 115.16c7.66 7.49 2.21 20.32-8.57 20.32h-71.49v116a12.07 12.07 0 0 1-12.1 12z"
                                        class="fa-primary"></path>
                                </g>
                            </svg>
                        </div>

                        <div class="post-score" id="rply-score-div-{{node.id}}">
                            {% subtract_and_cool_number node.upvotes.count node.downvotes.count %}
                        </div>

                        {% if user.is_authenticated %}
                        <div class="post-vote-button downvote-button {% if user in node.downvotes.all %} sel {% endif %}" id="rply-dnvt-btn-{{ node.id }}" onclick="event.stopPropagation(); replyDownvote(event, {{node.id}});">
                        {% else %}    
                        <div class="post-vote-button downvote-button" onclick="event.stopPropagation();">
                        {% endif %}

                            <svg aria-hidden="true" focusable="false" data-prefix="fad" data-icon="arrow-alt-square-down" role="img"
                                xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"
                                class="svg-inline--fa fa-arrow-alt-square-down fa-w-14 fa-9x">
                                <g class="fa-group">
                                    <path fill="currentColor"
                                        d="M400 32H48A48 48 0 0 0 0 80v352a48 48 0 0 0 48 48h352a48 48 0 0 0 48-48V80a48 48 0 0 0-48-48zm-51.58 244.32l-116 115.16a12.08 12.08 0 0 1-17 0L99.58 276.32c-7.66-7.49-2.21-20.32 8.57-20.32h71.49V140a12.07 12.07 0 0 1 12.1-12h64.52a12.07 12.07 0 0 1 12.1 12v116h71.49c10.78 0 16.23 12.83 8.57 20.32z"
                                        class="fa-secondary"></path>
                                    <path fill="currentColor"
                                        d="M191.74 128h64.52a12.07 12.07 0 0 1 12.1 12v116h71.49c10.78 0 16.23 12.83 8.57 20.32l-116 115.16a12.08 12.08 0 0 1-17 0L99.58 276.32c-7.66-7.49-2.21-20.32 8.57-20.32h71.49V140a12.07 12.07 0 0 1 12.1-12z"
                                        class="fa-primary"></path>
                                </g>
                            </svg>
                        </div>

                    </div>

                    <div class="comm-content-box-2">
                        
                        <div class="post-info">
                            
                            
                            <a href="{% url 'profile' node.author.username %}" onclick="event.stopPropagation();">u/{{ node.author }}</a>
                            <div class="post-time">
                                | {{ node.dt_creation | naturaltime }}
                            </div>
                            |                                        
                            {% with node.children.count as node_reply_count %}
                                {% if node_reply_count == 1 %}
                                    1 reply
                                {% else %}
                                    {{ node_reply_count }} replies
                                {% endif %}
                            {% endwith %} 
                        </div>
                        
                        <div class="post-text">
                            {{ node.content|safe }}
                        </div>
                        
                        {% if user.is_authenticated %}
                        <div class="post-options">
                            <div class="post-options-button rply-btn" id="rply-rply-btn-{{node.id}}" onclick="event.stopPropagation(); appendReplyCreateBox({{node.id}})">
                                <svg aria-hidden="true" focusable="false" data-prefix="fad" data-icon="reply" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="svg-inline--fa fa-reply fa-w-16 fa-9x"><g class="fa-group"><path fill="currentColor" d="M512 322.33c0 61.44-39.58 122.3-83.33 154.13-13.66 9.93-33.11-2.54-28.08-18.63 45.34-145-21.51-183.51-176.59-185.75v-136c160.63 1.83 288 34.02 288 186.25z" class="fa-secondary"></path><path fill="currentColor" d="M224 360c0 20.7-24.3 31.45-39.69 18.16l-176-152a24 24 0 0 1 0-36.32l176-152C199.72 24.55 224 35.35 224 56z" class="fa-primary"></path></g></svg>
                                <div class="post-options-button-text">
                                    Reply
                                </div>
                            </div>
                            <div class="post-options-button" onclick="event.stopPropagation();">
                                <svg aria-hidden="true" focusable="false" data-prefix="fad" data-icon="share-alt" role="img"
                                    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"
                                    class="svg-inline--fa fa-share-alt fa-w-14 fa-9x">
                                    <g class="fa-group">
                                        <path fill="currentColor"
                                            d="M155.79 180.9l102.49-64.06a95.93 95.93 0 0 0 33.93 54.26l-102.49 64.06a95.93 95.93 0 0 0-33.93-54.26zm136.42 160l-102.49-64.06a95.93 95.93 0 0 1-33.93 54.26l102.49 64.06a95.93 95.93 0 0 1 33.93-54.26z"
                                            class="fa-primary"></path>
                                        <path fill="currentColor"
                                            d="M96 160a96 96 0 1 0 96 96 96 96 0 0 0-96-96zm256 32a96 96 0 1 0-96-96 96 96 0 0 0 96 96zm0 128a96 96 0 1 0 96 96 96 96 0 0 0-96-96z"
                                            class="fa-secondary"></path>
                                    </g>
                                </svg>
                                <div class="post-options-button-text">Share</div>
                            </div>
                        </div>
                        {% endif %}

                        {% if not node.is_leaf_node and node.level == 4 %}
                        <div class="post-options" id="show-reply-more-{{node.id}}">                            
                            <div class="info-text reply-more">..............................................................</div>
                            <div class="post-options-button" onclick="event.stopPropagation();">
                                <svg aria-hidden="true" focusable="false" data-prefix="fad" data-icon="external-link" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="svg-inline--fa fa-external-link fa-w-16 fa-9x"><g class="fa-group"><path fill="currentColor" d="M400 320h32a16 16 0 0 1 16 16v128a48 48 0 0 1-48 48H48a48 48 0 0 1-48-48V112a48 48 0 0 1 48-48h160a16 16 0 0 1 16 16v32a16 16 0 0 1-16 16H64v320h320V336a16 16 0 0 1 16-16z" class="fa-secondary"></path><path fill="currentColor" d="M484 224h-17.88a28 28 0 0 1-28-28v-.78L440 128 192.91 376.91A24 24 0 0 1 159 377l-.06-.06L135 353.09a24 24 0 0 1 0-33.94l.06-.06L384 72l-67.21 1.9A28 28 0 0 1 288 46.68V28a28 28 0 0 1 28-28h158.67A37.33 37.33 0 0 1 512 37.33V196a28 28 0 0 1-28 28z" class="fa-primary"></path></g></svg>                                    <div class="post-options-button-text">
                                    Show full reply-thread
                                </div>
                            </div>
                        </div>
                        {% endif %}

                        {% if user.is_authenticated %}
                        <span class="reply-box-insert" id="repbx-ins-{{node.id}}" parent="{{node.id}}">

                        </span>
                        {% endif %}

                        <span id="new-sub-replies-{{node.id}}"></span>
                        {% if not node.is_leaf_node and node.level < 4 %}
                            {{ children }}
                        {% endif %}
                    </div>

                </div>
                {% endrecursetree %}

            </div>



            <!-- sidebar -->
            <div class="comm-1-2 wrap-sidebar">
                <div class="comm-sidebar">

                    <div class="comm-sidebar-box top"> 

                        <div class="comm-sidebar-box-heading comm-sidebar-box-content list-item" onclick="event.stopPropagation(); window.location.href='{% url 'community-home' post.community.name %}'">      
                            <div class="post-community-image-wrapper">
                                <img class="post-community-image sdbr p" src="{{ post.community.icon.url }}" alt="Community Icon">
                            </div>
                            <div class="post-community-name sdbr p">    
                                <a>c/{{ post.community.name }}</a>
                            </div>
                        </div>

                        <div class="comm-sidebar-box-content">      
                            <div class="post-community-name">    
                                <a>{{ post.community.about }}</a>
                            </div>
                        </div>
                        <hr class="list-sep">

                        <div class="comm-sidebar-box-content">      
                            <div class="post-community-name comm-abt">
                                {% with post.community.members.count as memb_count %}
                                    {% if memb_count == 1 %}    
                                        <a><strong>1</strong> member</a>
                                    {% else %}
                                        <a><strong>{{ memb_count | cool_number }}</strong> members</a>
                                    {% endif %}
                                {% endwith %}
                            </div>
                        </div>
                        <hr class="list-sep">
                        

                        <div class="comm-sidebar-box-content">  
                            <div class="post-community-name comm-create">   
                                <svg aria-hidden="true" focusable="false" data-prefix="fad" data-icon="birthday-cake" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="svg-inline--fa fa-birthday-cake fa-w-14 fa-9x"><g class="fa-group"><path fill="currentColor" d="M373.5 384c-28 0-31.39 32-74.75 32-43.55 0-46.6-32-74.75-32-27.28 0-31.66 32-74.5 32-43.5 0-46.8-32-74.75-32S43.36 416 0 416v96h448v-96c-43.25 0-47-32-74.5-32zM96 96c17.75 0 32-13.5 32-40S108 0 96 0c0 41-32 33-32 64a31.9 31.9 0 0 0 32 32zm128 0c17.75 0 32-13.5 32-40S236 0 224 0c0 41-32 33-32 64a31.9 31.9 0 0 0 32 32zm128 0c17.75 0 32-13.5 32-40S364 0 352 0c0 41-32 33-32 64a31.9 31.9 0 0 0 32 32z" class="fa-secondary"></path><path fill="currentColor" d="M448 384c-28 0-31.26-32-74.5-32-43.43 0-46.83 32-74.75 32-27.7 0-31.45-32-74.75-32-42.84 0-47.22 32-74.5 32-28.15 0-31.2-32-74.75-32S28.1 384 0 384v-80a48 48 0 0 1 48-48h16V112h64v144h64V112h64v144h64V112h64v144h16a48 48 0 0 1 48 48z" class="fa-primary"></path></g></svg>   
 
                                <a>Created {{ post.community.dt_creation | date:"DATE_FORMAT" }}</a>
                            </div>
                        </div>

                        <hr class="list-sep">

                        <div class="comm-sidebar-box-content">      
                            {% if user.is_authenticated %}
                                {% if user == post.community.creator or user in post.community.admins %}
                                <div class="community-button sdbr" onclick = "window.location.href='{% url 'community-update' post.community.name %}'">
                                    <div class="community-button-text p-comm-btn">
                                        <svg aria-hidden="true" focusable="false" data-prefix="fad" data-icon="wrench" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="svg-inline--fa fa-wrench fa-w-16 fa-9x"><g class="fa-group"><path fill="currentColor" d="M322 280.47l-.26.26a144.62 144.62 0 0 1-90.3-90.64L18.09 403.41a64 64 0 0 0 90.5 90.5L322 280.49zM63.35 472.65a24 24 0 1 1 24-24 24 24 0 0 1-24 24z" class="fa-secondary"></path><path fill="currentColor" d="M469.69 246.2c-40 40-97.48 51-147.72 34.27l-.26.26a144.64 144.64 0 0 1-90.41-90.94l.13-.13c-16.54-50.17-5.6-107.71 34.13-147.4a144.38 144.38 0 0 1 136.91-38 12 12 0 0 1 5.67 20.19l-74.53 74.48 11.33 68L413 178.28l74.53-74.52a12 12 0 0 1 20.17 5.52 144 144 0 0 1-38.01 136.92z" class="fa-primary"></path></g></svg>
                                        <div>MANAGE</div>
                                    </div>
                                </div>
                                {% else %}
                                <div class="community-button p-comm-btn-join sdbr">
                                    <div class="community-button-text p-comm-btn">
                                        <svg aria-hidden="true" focusable="false" data-prefix="fad" data-icon="user-check" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" class="svg-inline--fa fa-user-check fa-w-20 fa-9x"><g class="fa-group"><path fill="currentColor" d="M636.6 159.6a12 12 0 0 1-.1 16.8L495.2 316.6a11.86 11.86 0 0 1-16.8-.1l-81.7-82.3a11.86 11.86 0 0 1 .1-16.8l28.1-27.9a11.86 11.86 0 0 1 16.8.1l45.5 45.8 104.8-104a11.86 11.86 0 0 1 16.8.1z" class="join-tick {% if user_is_member %} fa-secondary {% endif %}"></path><path fill="currentColor" d="M224 256A128 128 0 1 0 96 128a128 128 0 0 0 128 128zm89.6 32h-16.7a174.08 174.08 0 0 1-145.8 0h-16.7A134.43 134.43 0 0 0 0 422.4V464a48 48 0 0 0 48 48h352a48 48 0 0 0 48-48v-41.6A134.43 134.43 0 0 0 313.6 288z" class="fa-primary"></path></g></svg>
                                        <div class="p-comm-btn-join-text">
                                        {% if user_is_member %}
                                            JOINED
                                        {% else %}
                                            JOIN
                                        {% endif %}
                                        </div>
                                    </div>
                                </div>
                                {% endif %}
                            {% else %}
                            <div class="community-button p-comm-btn-join sdbr" onclick="window.location.href='{% url 'login' %}?next={{request.path}}'">
                                <div class="community-button-text p-comm-btn">
                                    <svg aria-hidden="true" focusable="false" data-prefix="fad" data-icon="user-check" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" class="svg-inline--fa fa-user-check fa-w-20 fa-9x"><g class="fa-group"><path fill="currentColor" d="M636.6 159.6a12 12 0 0 1-.1 16.8L495.2 316.6a11.86 11.86 0 0 1-16.8-.1l-81.7-82.3a11.86 11.86 0 0 1 .1-16.8l28.1-27.9a11.86 11.86 0 0 1 16.8.1l45.5 45.8 104.8-104a11.86 11.86 0 0 1 16.8.1z" class="join-tick"></path><path fill="currentColor" d="M224 256A128 128 0 1 0 96 128a128 128 0 0 0 128 128zm89.6 32h-16.7a174.08 174.08 0 0 1-145.8 0h-16.7A134.43 134.43 0 0 0 0 422.4V464a48 48 0 0 0 48 48h352a48 48 0 0 0 48-48v-41.6A134.43 134.43 0 0 0 313.6 288z" class="fa-primary"></path></g></svg>
                                    <div class="p-comm-btn-join-text">JOIN</div>
                                </div>
                            </div>
                            {% endif %}


                        </div>

                    </div>
                    
                    {% if p_c_top_posts %}
                    <div class="comm-sidebar-box"> 
                        <div class="comm-sidebar-box-heading">
                            Top Posts in c/{{ post.community.name }} 
                        </div>
                        {% for post in p_c_top_posts %}
                        <div class="comm-sidebar-box-content list-item" onclick="event.stopPropagation(); window.location.href='{% url 'post-detail' post.slug %}'">      
                            {% if post.is_article %}
                                {% if post.article.main_img_url %}
                                    <div class="post-community-image-wrapper">
                                        <img class="post-community-image post-main-img sdbr" src="{{ post.article.main_img_url }}" alt="Community Icon">
                                    </div>
                                    <div class="post-community-name sdbr">    
                                        <a>{{ post.title | truncatechars:29 }}</a> | <small>Article</small><br/>
                                        <small>{{ post.get_timesince_minified }} | {{ post.get_reply_count | cool_number }} replies | {{ post.get_score | cool_number }} pts</small>
                                    </div>
                                {% else %}
                                <div class="post-community-name sdbr">    
                                    <a>{{ post.title | truncatechars:38 }}</a> | <small>Article</small><br/>
                                    <small>{{ post.get_timesince_minified }} | {{ post.get_reply_count | cool_number }} replies | {{ post.get_score | cool_number }} pts</small>
                                </div>
                                {% endif %}
                            {% else %}
                            <div class="post-community-name sdbr">    
                                <a>{{ post.title | truncatechars:38 }}</a> | <small>Thread</small><br/>
                                <small>{{ post.get_timesince_minified }} | {{ post.get_reply_count | cool_number }} replies | {{ post.get_score | cool_number }} pts</small>
                            </div>
                            {% endif %}
                        </div>
                        <hr class="list-sep">
                        {% endfor %}
                        <div class="comm-sidebar-box-content">      
                            <div class="community-button sdbr">
                                <div class="community-button-text" onclick="event.stopPropagation(); window.location.href='{% url 'community-home' post.community.name %}'">VIEW ALL</div>
                            </div>
                        </div>

                    </div>
                    {% endif %}


                    {% if sugg_comm or sugg_posts %}
                    <div class="comm-sidebar-box">             
                    </div>
                    {% endif %}

                    {% if sugg_comm %}
                    <div class="comm-sidebar-box"> 
                        <div class="comm-sidebar-box-heading">
                            Suggested Communities 
                        </div>
                        {% for community in sugg_comm %}
                        <div class="comm-sidebar-box-content list-item" onclick="event.stopPropagation(); window.location.href='{% url 'community-home' community.name %}'">      
                            <div class="post-community-image-wrapper">
                                <img class="post-community-image sdbr" src="{{ community.icon.url }}" alt="Community Icon">
                            </div>
                            <div class="post-community-name sdbr">    
                                <a>c/{{ community.name }}</a>
                            </div>
                        </div>
                        <hr class="list-sep">
                        {% endfor %}
                        <div class="comm-sidebar-box-content">      
                            <div class="community-button sdbr" onclick="event.stopPropagation(); window.location.href='{% url 'suggested' %}'">
                                <div class="community-button-text">VIEW ALL</div>
                            </div>
                        </div>

                    </div>
                    {% endif %}

                    {% if sugg_posts %}
                    <div class="comm-sidebar-box"> 
                        <div class="comm-sidebar-box-heading">
                            Suggested Posts
                        </div>
                        {% for post in sugg_posts %}
                        <div class="comm-sidebar-box-content list-item" onclick="event.stopPropagation(); window.location.href='{% url 'post-detail' post.slug %}'">      
                            {% if post.is_article %}
                                {% if post.article.main_img_url %}
                                    <div class="post-community-image-wrapper">
                                        <img class="post-community-image post-main-img sdbr" src="{{ post.article.main_img_url }}" alt="Community Icon">
                                    </div>
                                    <div class="post-community-name sdbr">    
                                        <a>{{ post.title | truncatechars:29 }}</a> | <small>Article | {{ post.get_reply_count | cool_number }} replies</small><br/>
                                        <small>c/{{ post.community.name | truncatechars:10 }} | {{ post.get_timesince_minified }} | {{ post.get_score | cool_number }} pts</small>
                                    </div>
                                {% else %}
                                <div class="post-community-name sdbr">    
                                    <a>{{ post.title | truncatechars:38 }}</a> | <small>Article | {{ post.get_reply_count | cool_number }} replies</small><br/>
                                    <small>c/{{ post.community.name | truncatechars:15 }} | {{ post.get_timesince_minified }} | {{ post.get_score | cool_number }} pts</small>
                                </div>
                                {% endif %}
                            {% else %}
                            <div class="post-community-name sdbr">    
                                <a>{{ post.title | truncatechars:38 }}</a> | <small>Thread | {{ post.get_reply_count | cool_number}} replies</small><br/>
                                <small>c/{{ post.community.name | truncatechars:15 }} | {{ post.get_timesince_minified }} | {{ post.get_score | cool_number }} pts</small>
                            </div>
                            {% endif %}
                        </div>
                        <hr class="list-sep">
                        {% endfor %}
                        <div class="comm-sidebar-box-content">      
                            <div class="community-button sdbr" onclick="event.stopPropagation(); window.location.href='{% url 'suggested' %}'">
                                <div class="community-button-text">VIEW ALL</div>
                            </div>
                        </div>

                    </div>
                    {% endif %}
                    
                    <section class="site-footer">
                        <div class="comm-sidebar-box">             
                        </div>

                        <div class="comm-sidebar-box comm-sidebar-footer">  
                            <div class="comm-sidebar-box-content sidebox-footer">      
                                <div class="sidebox-footer-1">
                                    <a >Help</a>
                                    <a >App</a>
                                    <a href="{% url 'trending-communities' %}">Communities</a>
                                    <a href="{% url 'top' %}">Top Posts</a>
                                    <a >Topics</a>
                                </div>
                                <div class="sidebox-footer-2">
                                    <a >About</a>
                                    <a >Careers</a>
                                    <a >Advertise</a>
                                    <a >Blog</a>
                                    <a >Terms</a>
                                    <a >Policies</a>
                                </div>
                            </div>
                            <hr>
                            <div class="comm-sidebar-box-content wroovie-logo">      
                                wroovie.com Â© 2020
                            </div> 
                        </div>
                    </section>
                </div>
            </div>
        </div>
        

    </div>

    
    <!-- {% if is_paginated %}
    
        {% if page_obj.has_previous %}
            <a class="btn btn-outline-info mb-4" href="?page=1">First</a>
            <a class="btn btn-outline-info mb-4" href="?page={{ page_obj.previous_page_number }}">Previous</a>
        {% endif %}
        
        {% for num in page_obj.paginator.page_range %}
            {% if page_obj.number == num %}
                <a class="btn btn-info mb-4" href="?page={{ num }}">{{ num }}</a>
            {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
                <a class="btn btn-outline-info mb-4" href="?page={{ num }}">{{ num }}</a>
            {% endif %}
        {% endfor %}

        {% if page_obj.has_next %}
            <a class="btn btn-outline-info mb-4" href="?page={{ page_obj.next_page_number }}">Next</a>
            <a class="btn btn-outline-info mb-4" href="?page={{ page_obj.paginator.num_pages }}">Last</a>
        {% endif %}

    {% endif %} -->

{% endblock %}


{% block extrajs %}
    <script src="{% static 'common/js/jquery-3.4.1.min.js' %}" type="text/javascript"></script>

    <script type="text/javascript">
        // define variables
        var user_is_member = '{{ user_is_member }}'==='True'?true:false;
        var community_name = '{{ post.community.name }}'
        var post_slug = '{{ post.slug }}'
    </script>

    <script src="{% static 'posts/js/base.js' %}" type="text/javascript"></script>
    <script src="{% static 'posts/js/server.js' %}" type="text/javascript"></script>
    {% if user.is_authenticated %}
    <script src="{% static 'posts/js/vote.js' %}" type="text/javascript"></script>
    {% endif %}
    {% if user.is_authenticated %}
        <script src="{% static 'common/js/trix.js' %}" type="text/javascript"></script>
        <script src="{% static 'posts/js/reply.js' %}" type="text/javascript"></script>
        <script src="{% static 'posts/js/post_save.js' %}" type="text/javascript"></script>
    {% endif %}

{% endblock %}